<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/google-map/google-map.html">
<link rel="import" href="../../../bower_components/google-map/google-map-marker.html">

<dom-module id="maps-section">
    <template>
        <style>

            google-map {
                height: 600px;

            }


            .lh {
                @apply(--layout-horizontal);
            }

            .content-wrapper {
                @apply(--layout-horizontal);
                @apply(--layout-center-justified);
                background-color: var(--light-primary-color);
            }

            .fl-9 {
                @apply(--layout-flex-9);
            }

            .fl-3 {
                @apply(--layout-flex-3);
                @apply(--layout-horizontal);
                @apply(--layout-center-justified);
            }

            .text-content {
                @apply(--layout-vertical);
                @apply(--layout-center-justified);
            }

            p {
                font-weight: 300;
                font-size: 16px;
                line-height: 24px;
                text-align: center;
                letter-spacing: .1px;
                max-width: 250px;
            }

            h2 {
                padding: 0 8px 0 8px;
                font-weight: normal;
                text-align: center;
                font-size: 20px;
                margin-bottom: 0
            }

            google-map a {
                text-decoration: none;
                color: var(--accent-color);
            }

            .padding {
                padding: 4px;
            }

            .padding-circle {
                padding-left: 68px;
            }

            .circle {
                border-radius: 50%;
            }

            @media (max-width: 841px) {

                .content-wrapper{
                    @apply(--layout-vertical-reverse);
                }
            }
        </style>
        <section>
            <div class="content-wrapper section-world">
                <div class="fl-9">

                    <template is="dom-if" if="{{apiKey}}">
                        <google-map
                          id="map"
                          api-key="[[apiKey]]"
                          zoom="7"
                          max-zoom="14"
                          min-zoom="7"
                          latitude="44.264879216821896"
                          longitude="9.156107191162176">
                            <template is="dom-repeat" items="{{places}}" as="place">
                                <google-map-marker map={{map}} latitude="{{place.geo_coordinate.latitude}}" longitude="{{place.geo_coordinate.longitude}}">
                                    <div class="lh padding">
                                        <!--<img class="circle" src="{{place.cover}}&rendition=maxi-icon">-->
                                        <img class="circle" src="{{place.cover}}" height="56" width="56">
                                        <a href="/place/{{place.id}}"><h2>{{place.name}}</h2></a>
                                    </div>
                                    <div class="lh padding padding-circle">
                                        badges
                                    </div>
                                </google-map-marker>
                            </template>
                        </google-map>
                    </template>
                </div>
                <div class="fl-3">
                    <div  class="text-content">
                        <p>Diamo voce a chi ama la subacquea e le avventure sottomarine! Il nostro obiettivo è quello di far conoscere, per esperienza diretta, i siti di immersioni più intriganti, accattivanti e particolari, per poter indirizzare gli appassionati a quanto di più bello ci aspetta nel blu. Lascia il tuo ricordo e contribuisci a far vivere esperienze subacquee indimenticabili. Grazie per il tuo aiuto.</p>
                    </div>
                </div>
            </div>
        </section>
    </template>
    <script>
        (function() {
            'use strict';

            Polymer({
                is: 'maps-section',

                properties: {
                    places: {
                        type: Array
                    },
                    apiKey: {
                        type: String
                    }
                },

                ready: function () {
                    var apikey = new Polymer.IronMetaQuery({type:'google-map', key: 'apikey'}).value;
                    if (!apikey) {
                        console.warn('Apikey not found');
                    } else {
                        this.apiKey = apikey;
                    }
                },

                attached: function () {
                    var maps = this.querySelector('google-map');
                    var marker = document.createElement('google-map-marker');
                    marker.setAttribute('latitude', 44.0645037);
                    marker.setAttribute('longitude', 9.6405873);
                    marker.setAttribute('title', "Dynamic marker");
                    Polymer.dom(maps).appendChild(marker);
                }
            });
        })();
    </script>
</dom-module>